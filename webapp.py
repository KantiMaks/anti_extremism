import streamlit as st
import pandas as pd
import numpy as np
from functions import custom_input_prediction  # –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Å–≤–æ—é —Ñ—É–Ω–∫—Ü–∏—é
from PIL import Image
import pickle

st.set_page_config(page_title="–î–µ—Ç–µ–∫—Ç–æ—Ä —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç–æ–≤", layout="centered")
st.title("üõ°Ô∏è –ú–æ–¥–µ–ª—å –ø–æ —Ä–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏—é —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç–∫–∏—Ö –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π")

st.markdown("""
–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–æ–≥–æ –∏–ª–∏ –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.  
–í–æ–∑–º–æ–∂–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
- **–ü–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º**
- **–≠—Ç–Ω–∏—á–µ—Å–∫–∞—è –Ω–µ–Ω–∞–≤–∏—Å—Ç—å**
- **–†–µ–ª–∏–≥–∏–æ–∑–Ω–∞—è –Ω–µ–Ω–∞–≤–∏—Å—Ç—å**
- **–ü—Ä–æ—á–∏–π —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º**
- **–ù–µ —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç**
***
""")

# –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞
st.header("üîç –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞")
tweet_input = st.text_area("–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è", height=150)

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–≤–µ–¥—ë–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
if tweet_input.strip():
    st.subheader("–í—ã –≤–≤–µ–ª–∏:")
    st.info(tweet_input)
else:
    st.warning("‚õî –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.")

st.markdown("***")


# –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
if tweet_input.strip():
    st.header("üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞")
    try:
        prediction = custom_input_prediction(tweet_input)
        st.write(f"–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏: {prediction}")  # –î–ª—è –æ—Ç–ª–∞–¥–∫–∏

        if prediction is None:
            st.error("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å –º–æ–¥–µ–ª—å –∏ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ç–æ—Ä.")
        elif prediction == "political":
            st.success("üü• –û–±–Ω–∞—Ä—É–∂–µ–Ω –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º")
        elif prediction == "ethnicity":
            st.success("üüß –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —ç—Ç–Ω–∏—á–µ—Å–∫–∞—è –Ω–µ–Ω–∞–≤–∏—Å—Ç—å")
        elif prediction == "religious":
            st.success("üü® –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω–∞—è –Ω–µ–Ω–∞–≤–∏—Å—Ç—å")
        elif prediction == "non_extremist":
            st.info("üü© –≠–∫—Å—Ç—Ä–µ–º–∏–∑–º–∞ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ")
        elif prediction.lower() == "other extremism":
            st.warning("‚¨ú –û–±–Ω–∞—Ä—É–∂–µ–Ω –¥—Ä—É–≥–æ–π —Ç–∏–ø —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º–∞")
        elif prediction == "Unknown":
            st.error("‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∏ –æ–¥–Ω–æ–π –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.")
        else:
            st.error(f"‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {prediction}")

    except Exception as e:
        st.error(f"üö´ –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Ç–µ–∫—Å—Ç–∞: {e}")
